---
date: 2025-03-28
title: C语言内存管理
category: c语言
tags:
  - c
description: 在c语言中内存分配包括静态和动态两种类型，本文是各种内存申请方式的详细介绍（DS）
---
# 内存的分配
::: info 内存分配的类型
分为三种：静态内存、栈内存、堆内存
:::

#### **1. 静态内存分配**
- **定义**：在编译时确定大小和位置，生命周期与程序一致。
    - **特点**：
        - 存放全局变量、静态变量、常量。
        - 无需手动管理，由系统自动分配和释放。
- **内存区域**：
    - **数据段（Data Segment）**：存放已初始化的全局变量和静态变量。
	- **BSS段（Block Started by Symbol）**：存放未初始化的全局变量和静态变量（默认初始化为0）。
    - **代码段（Text Segment）**：存放程序代码和常量（如字符串常量）。

```c
int global_var = 10;          // 数据段（.data）
static int static_var = 20;   // 数据段（.data）
char *str = "Hello";          // 代码段（.rodata，只读）

void func() {
    static int local_static;  // BSS段（.bss）
}
```

#### **2. 栈内存分配**

- **定义**：由编译器自动管理，存放函数内的局部变量和参数。
- **特点**：
    - 内存分配和释放自动完成（函数调用时分配，返回时释放）。
    - 大小固定且有限（默认1-8MB，超出导致栈溢出）。
    
```c
void func() {
    int a = 10;       // 栈内存分配
    char buffer[100]; // 栈内存分配（注意避免过大）
}
```

#### **3. 堆内存分配**

- **定义**：由程序员手动管理的内存区域，用于动态分配。    
- **特点**：    
    - 内存大小可在运行时动态调整。        
    - 需显式分配（`malloc`/`calloc`）和释放（`free`）。        
    - 内存泄漏风险高，需谨慎管理。        
- **示例**：
    
```c
int *arr = (int*)malloc(10 * sizeof(int)); // 堆内存分配
free(arr); // 必须手动释放
```

